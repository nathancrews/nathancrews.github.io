<!DOCTYPE html>
<html lang="en">

<head>
  <title>Nathan Crews Node.js Portfolio</title>
  <meta charset="UTF-8" />
  <script src="https://unpkg.com/htmx.org@2.0.0"
    integrity="sha384-wS5l5IKJBvK6sPTKa2WZ1js3d947pvWXbPJ1OmWfEuxLgeHcEbjUUA5i9V5ZkpCw"
    crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script> -->
  <link rel="stylesheet" href="styles/styles.css" />
  <script type="text/javascript">
    function loadApp() {
      console.log("Loading application page....");
      htmx.ajax('GET', 'cgi-bin/node_scripts/index.js?dir=uploads', '#file_results')
    }

    function loadAppOnEvent(evt)
    {
      loadApp()
    }

    window.onload = function (e) { loadApp() }
  </script>
</head>
<body>
  <div style="position: fixed;">
    <h1>Application Projects</h1>
    <nav>
      <ul>
        <li><a href="https://www.nathancrews.com/index.html">Uploads</a></li>
        <li><a href="https://www.nathancrews.com/cgi-bin/image-geo/image-geo.js?dir=images/drone/germany/">Drone: Germany</a></li>
        <li><a href="https://www.nathancrews.com/cgi-bin/image-geo/image-geo.js?dir=images/drone/sheffield/">Drone: Sheffield</a></li>
        <li><a href="https://www.nathancrews.com/cgi-bin/image-geo/image-geo.js?dir=images/drone/indiancreek/">Drone: Bridge</a></li>
        <li><a href="https://www.nathancrews.com/test_node.html">File Listing</a></li>
      </ul>
    </nav>
  </div>
  <br />
  <div id="project" class="projectBox">
    <div>
      <span style="width:100%;">
        <h3>Mouse over file name to see generated image.</h3>
        <!-- <button id="update_now" style="height:25px; opacity: 1%;" type="submit"
          hx-get="cgi-bin/node_scripts/index.js?dir=uploads" hx-trigger="click" hx-target="#file_results">Refresh File
          List Now</button> -->
        <label style="opacity: 1%;">=========================================></label>
        <img id="loading" width="25px" height="25px" src="images/loading.gif" class="htmx-indicator" alt="Loading..." />
      </span>
    </div>
    <form style="margin-top: 5px;" hx-encoding="multipart/form-data" method="post" enctype="multipart/form-data">
      <label for="file">Upload Files:</label>
      <input id="file" name="file" type="file" multiple class="form-control-file border"
        accept=".las,.laz,.gltf,.glb,.jpg,.png,.bin,.xml,.XML" />
      <input id="redirectCGI" name="redirectCGI" hidden="true" value="node_scripts/index.js?dir=uploads&filename=dc.laz" />
      <input id="fileTypePathMap" name="fileTypePathMap" hidden="true"
        value="uploads/las=.las,.laz,.LAZ,.LAS&uploads/gltf=.gltf,.glb,.GLTF,.GLB,.jpg,.png,.bin&uploads/landxml=.xml,.XML" />
      <span>
        <button class="btn btn-primary" type="submit" hx-post="cgi-bin/ncupload.exe" hx-trigger="click"
          hx-target="#file_results" hx-indicator="#loading" hx-on:htmx:beforeSend="loadApp">Upload File(s)</button></span>
    </form>
    <div class="image-preview">
      <div id="file_results" class="file_list"></div>
      <div id="results" class="img_result"></div>
    </div>
  </div>
  <script>
        document.body.addEventListener('htmx:beforeSend', loadAppOnEvent());
  </script>
</body>
</html>